# 近战攻击 - Godot教程

大纲

- 创建Player
- 创建Player动画
  - Idle
  - attack
  - run
- 创建攻击区域
  - 响应攻击
- 创建敌人
  - 被攻击动画
  - 受到伤害



本教程以视频内容为基础，所以使用同样的素材。你也可以看视频：[MELEE ATTACKS](https://www.youtube.com/watch?v=AaJopFFkmNo&feature=emb_logo)。

之所以整理成文，是因为即使一个简单的动作，涉及的设置，代码可能会非常零散，且藏于大量的面板和设置项中，视频可以很形象的告诉你过程，但并不利于回头查看。往往一些内容很快你就会忘记，如果在视频里去找，太过伤身。所以，整理成文即是一个很好的回顾，也是一种便于查找的信息保留。

那么进入主题**近战攻击**，相信大家都打过架，所以，对近战攻击不会陌生，还有可能很熟悉。那么，在游戏里，我们要控制角色进行近战攻击需要哪些步骤呢？先看一个动画：

![](https://www.colorgamer.com/usr/uploads/2020/08/941828471.gif)

如图，可以简单的总结出需要的步骤：

- 需要一个角色
- 角色需要攻击动画
- 需要一个敌人
- 需要判定发起攻击
- 需要判定攻击命中
- 需要敌人被攻击动画

接下来，我们将一一进行制作

先给出本次要用到的素材：

![](https://www.colorgamer.com/usr/uploads/2020/08/3433055785.png)

它是一张Sheet图，所有帧都在一张图片上。将它放到项目文件夹里。



## 创建角色

新建一个场景**Scene -> New Scene**，在Scene面板中，选择**Other Node**，在弹出的窗口中搜索**KinematicBody2D**节点，点击**Create**创建它。

![](https://www.colorgamer.com/usr/uploads/2020/08/1821678098.png)

我们的角色都是基于**KinematicBody2D**节点的。

> **KinematicBody2D**：不完全受物理作用，但它可以受玩家控制，所以它可以移动也可以检测碰撞

创建好后，可以在Scene面板里看到，KinematicBody2D的后面个感叹号，不必紧张，它是在提醒我们：没有形状做碰撞检测。在本教程里，其实不涉及这一部分内容，所以，不管它也是没有问题的。

> 当然，如果实在看着难受，可以为其创建一个CollisionBody2D的子节点，选择这个子节点，在Inspector中，将Shape选择为Rectangle，感叹号就会消失。

双击KinematicBody2D节点，将其重命名为**Player**。右键点击**Player**节点，选择**Add Child Node**，为其添加一个**Sprite**节点作为子节点。

![](https://www.colorgamer.com/usr/uploads/2020/08/485486878.png)

在Scene里选中**Sprite**节点，将**FileSystem**中的**Player.png**（如果没有，请将教程开始的图片拖入FileSystem里）拖入右侧Inspector里**Texture**后的方框里。

![](https://www.colorgamer.com/usr/uploads/2020/08/2012381925.png)

这时在主视图里可以看到图片，但因为它是Sheet图，所有帧都显示了出来，显然这是不行的，所以需要进行一些设置。

Sheet图里，每一格就是一帧图像，通过数数，我们可以得到横向有13张图，纵向有8张，因此，在**Sprite**的Inspector里，点开**Animation**选项卡，将**Vframes**设置为8，**Hframes**设置为13，对应上Sheet图的格子数。这样，主场景里的图片，就只剩下左上角的那一格图像了。

![](https://www.colorgamer.com/usr/uploads/2020/08/776718417.png)



## 为角色添加动画

首先右键根节点**Player**，为其添加一个子节点**AnimationPlayer**，创建好后，可以到界面的下方多出一个面板，即动画面板。

![](https://www.colorgamer.com/usr/uploads/2020/08/3457204471.png)

选中**AnimationPlayer**节点，在它的**Inspector**里，将**Root Node**修改为**Sprite**。

![](https://www.colorgamer.com/usr/uploads/2020/08/29926011.png)

因为我们的图像都在Sprite上，所以需要选择它。

### 添加Idle动画（空闲动画）

来到动画面板，点击上方面的**Animation**按钮，在弹出的选项里选择**New**，输入动画名称**Idle**，点击OK创建动画。之后动画面板中多了一些东西。

![](https://www.colorgamer.com/usr/uploads/2020/08/1224524851.png)

在面板中，有一个时间轴，默认是1秒，在时间轴的右则。步长是0.1秒，在面板的下方的正中央。右下角可以缩放时间轴。

在添加动画之前，我们需要了解一下Sheet图在Sprite的Animation中是怎么运作的。

点击时间轴的第一帧，这一帧会被高亮，同时选中**Sprite**节点，