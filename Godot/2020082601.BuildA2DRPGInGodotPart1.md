# 如何制作2D RPG游戏 - Part 1- Godot3教程

![](https://www.colorgamer.com/usr/uploads/2020/08/512727219.png)

## 目录

1. 介绍
2. 项目文件
3. 项目设置
4. 创建Player
5. 编写Player移动脚本
6. Player动画
7. 创建Tilemap
8. 继续Part2



## 介绍

欢迎大家！即使游戏已经存在了很多年，但RPG（角色扮演）游戏仍然非常流行，很多有想法的开发者都想学习如何制作。然后，一款功能丰富的RPG游戏，可能很难知道要从哪里开始。庆幸的是，有了Godot和一些编程知识，你将拥有制作你梦想RPG需要的所有工具。

在这RPG系列教程里，我们将在Godot引擎中，一起创建2D RPG游戏。它包含至4方向角色控制器，敌人，战斗，战利品，甚至是等级系统。在Part 1，在构建RPG前，我们将介绍多个Godot的新系统，包含tilemaps，精灵动画和raycasting。这可能需要一些Godot引擎以及GDScript的基础知识。如果你刚开始接触Godot，建议先看看我们的新手教程。

不管怎么样，我们希望你能参与进来，并准备好学习如何使用Godot制作2D RPG游戏。

![](https://www.colorgamer.com/usr/uploads/2020/08/2521530833.gif)



## 项目文件

对于本项目，我们需要一些素材，如果精灵，字体。它们来自于[kenney.nl](https://kenney.nl/)和[Google Fonts](https://fonts.google.com/)。当然，你也可以使用自己的资源，但在本教程里，我们将使用它们。

- 下载精灵和字体素材以及完整的项目 [点这里](https://godottutorials.pro/rpg-godot-tutorial/)



## 项目设置

首先，创建一个新项目。在编辑器中，导入我们需要的素材。

![](https://www.colorgamer.com/usr/uploads/2020/08/1259194557.png)

之后在场景面板里选择**2D Scene**创建我们的第一个场景，重命名为**MainScene**，并保存。

![](https://www.colorgamer.com/usr/uploads/2020/08/2027357727.png)



## 创建Player

现在我们有了主场景，接着创建一个**KinematicBody2D**类型的新场景（Scene -> New Scene）。

- 重命名为**Player**
- 保存场景

给**Player**节点添加一个子节点

- 将**player_s_0.png**拖入到场景里，会创建一个新的sprite节点
- 设置position为0, 0
- 创建一个**CollisionShape2D**子节点
- 设置**Shape**为**Capsule**
- 调整它的大小覆盖sprite

目前，我们使用一个sprite节点作为player。稍后，我们将使用**AnimationSprte**节点来替换它。

![](https://www.colorgamer.com/usr/uploads/2020/08/40513135.png)

最后，为player创建**RayCast2D**节点。你将在场景里看到，一个箭头出现在了player上。这是raycast，它是游戏开发的一种机制，可以应用于许多不同的场景。raycast有一个源点位置和一个方向。它会从源点向给定方向射出一个点，如果这个点和一个碰撞体接触，它将会返回那个碰撞体和它的相关信息。

在这里，raycast具有最大距离，它将会探测可以交互的物体和敌人。



- 确保打开**Enabled**

![](https://www.colorgamer.com/usr/uploads/2020/08/2037738260.png)



## 编写Player移动脚本

现在，我们有了Player场景，让我们给kinematic body节点**Player**创建一个新的脚本。我们可以从变量开始。

```
var curHp : int = 10
var maxHp : int = 10
var moveSpeed : int = 250
var damage : int = 1
 
var gold : int = 0
 
var curLevel : int = 0
var curXp : int = 0
var xpToNextLevel : int = 50
var xpToLevelIncreaseRate : float = 1.2
 
var interactDist : int = 70
 
var vel = Vector2()
var facingDir = Vector2()
 
onready var rayCast = $RayCast2D
```

稍后，我们将添加更多的变量，但对于我们大多数系统来讲，这是需要的。现在，为了让player可以四处移动，我们需要知道按键都是什么。打开**Project Settings**窗口(Project > Project Settings...)，点击**Input Map**标签。我们需要添加5个新的动作，并为它们分配按键。

- move_left - 方向左键
- move_right - 方向右键
- move_up - 方向上键
- move_down - 方向下键
- interact - 空格

![](https://www.colorgamer.com/usr/uploads/2020/08/305326038.png)

回到脚本，我们可以创建**_physics_process**函数，一个内置函数，以60FPS运行（很好的物理处理函数）。在这些，我们想要做什么呢？几件事。

1. 重置**vel**（vector包含速度向量）
2. 监听4个方向键，改变速度和面朝方向（后面会使用动画）
3. 归一化速度向量防止过快的斜线移动
4. 使用KinematicBody2D节点函数根据速度移动player

```
func _physics_process (delta):
 
    vel = Vector2()
 
    # inputs
    if Input.is_action_pressed("move_up"):
        vel.y -= 1
        facingDir = Vector2(0, -1)
    if Input.is_action_pressed("move_down"):
        vel.y += 1
        facingDir = Vector2(0, 1)
    if Input.is_action_pressed("move_left"):
        vel.x -= 1
        facingDir = Vector2(-1, 0)
    if Input.is_action_pressed("move_right"):
        vel.x += 1
        facingDir = Vector2(1, 0)
 
    # normalize the velocity to prevent faster diagonal movement
    vel = vel.normalized()
 
    # move the player
    move_and_slide(vel * moveSpeed, Vector2.ZERO)
```

